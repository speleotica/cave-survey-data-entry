(()=>{"use strict";var t={3738:function(t,e,n){var i=n(4752),l=n(5271),o=n(8751);let r=(0,n(5444).Z)({palette:{mode:"light"},components:{MuiAlert:{styleOverrides:{root:t=>{let{ownerState:e}=t;return{..."info"===e.severity&&{backgroundColor:"#60a5fa"}}}}},MuiInputBase:{defaultProps:{disableInjectingGlobalStyles:!0}}}});var a=n(7297),s=n(3198),u=n(8548),d=n(9890),c=n(9321),h=n(5181),f=n(7413),g=n(6633),m=n(5929),p=n(7882);let v=f.ZP.object({station:f.ZP.string().trim().optional(),left:f.ZP.number().nonnegative().finite().optional(),right:f.ZP.number().nonnegative().finite().optional(),up:f.ZP.number().nonnegative().finite().optional(),down:f.ZP.number().nonnegative().finite().optional()}),Z=f.ZP.number().min(0).lt(360).finite(),x=f.ZP.number().gte(-90).lte(90).finite(),b=(0,g.bN)(f.ZP.string().regex(/^\s*[-+]?(\d+(\.\d*)?|\.\d+)(e[-+]?\d+)?\s*(\*\s*)?$/i,"invalid number"),t=>/\s*\*\s*$/.test(t)?[parseFloat(t.replace(/\s*\*\s*$/,"")),{excluded:!0}]:parseFloat(t),f.ZP.union([f.ZP.number().positive().finite(),f.ZP.tuple([f.ZP.number(),f.ZP.object({excluded:f.ZP.literal(!0)})]).refine(t=>t[0]>0,"Number must be greater than 0").refine(t=>Number.isFinite(t[0]),"Number must be finite")]),t=>"number"==typeof t?String(t):`${t[0]} *`);function y(t){return"number"==typeof t?t:null==t?void 0:t[0]}function w(t){return!!Array.isArray(t)&&t[1].excluded}let I=f.ZP.object({from:v.optional(),to:v.optional(),isSplit:f.ZP.boolean().optional(),distance:b.optional(),frontsightAzimuth:Z.optional(),backsightAzimuth:Z.optional(),frontsightInclination:x.optional(),backsightInclination:x.optional(),notes:f.ZP.string().trim().optional()}),S=f.ZP.enum(["IMO","Lech","X-38","X-39","FromStaDisAzIncLrUd","ToStaDisAzIncLrUd"]),P=f.ZP.object({x:f.ZP.number(),y:f.ZP.number()}),k=f.ZP.object({topLeft:P,topRight:P,bottomLeft:P,bottomRight:P}),A=f.ZP.object({layoutVariant:S.optional(),bounds:k.optional(),shots:f.ZP.array(I.optional()).default([])}),F=f.ZP.object({imageId:f.ZP.string().uuid(),tables:f.ZP.array(A).default([])}),L=f.ZP.enum(["meters","feet"]),z=f.ZP.enum(["degrees","gradians","mils"]),U=(0,g.bN)(f.ZP.string().superRefine((t,e)=>{try{(0,m.gw)(t)}catch(t){e.addIssue({code:f.ZP.ZodIssueCode.custom,message:t instanceof Error?t.message:String(t)})}}),t=>{try{let e=(0,m.gw)(t);if(Array.isArray(e))return e[0];return e}catch(t){return new Date(NaN)}},f.ZP.date(),t=>t.toLocaleDateString()),C=f.ZP.object({cave:f.ZP.string().trim().optional(),name:f.ZP.string().trim().default(""),team:f.ZP.string().trim().default(""),date:U.optional(),distanceUnit:L,angleUnit:z,backsightAzimuthCorrected:f.ZP.boolean().default(!0).optional(),backsightInclinationCorrected:f.ZP.boolean().default(!0).optional(),frontsightBacksightTolerance:f.ZP.number().positive().default(2)}),D=f.ZP.object({outputFormat:f.ZP.enum(["FRCS","Compass","Walls"]).optional(),tripHeader:C,hideHeader:f.ZP.boolean().optional(),hideOverlay:f.ZP.boolean().optional(),pages:f.ZP.array(F).default([])}),B=D.superRefine((t,e)=>{let{tripHeader:n,pages:i}=t,{backsightAzimuthCorrected:l,backsightInclinationCorrected:o,frontsightBacksightTolerance:r}=n,a="mils"===n.angleUnit?p.Angle.milsNATO:p.Angle[n.angleUnit],s=null!=r?new p.UnitizedNumber(r,a):p.Unitize.degrees(2);for(let t=0;t<i.length;t++){let{tables:n}=i[t];for(let i=0;i<n.length;i++){let{shots:r}=n[i];for(let n=0;n<r.length;n++){let u=r[n];if(!u)continue;let{frontsightAzimuth:d,frontsightInclination:c}=u,{backsightAzimuth:h,backsightInclination:g}=u;if(null!=d&&null!=h){let o=new p.UnitizedNumber(d,a),r=new p.UnitizedNumber(h,a);l||(r=p.Angle.opposite(r));let u=o.sub(r).abs();if(u.compare(p.Unitize.degrees(180))>=0&&(u=p.Angle.opposite(u)),u.compare(s)>0){let l=[...e.path,"pages",t,"tables",i,"shots",n];e.addIssue({path:[...l,"frontsightAzimuth"],code:f.ZP.ZodIssueCode.custom,message:`Warning: differs from backsight by ${O(u,2)} (must be within ${s.toString()})`}),e.addIssue({path:[...l,"backsightAzimuth"],code:f.ZP.ZodIssueCode.custom,message:`Warning: differs from frontsight by ${O(u,2)} (must be within ${s.toString()})`})}}if(null!=c&&null!=g){let l=new p.UnitizedNumber(c,a),r=new p.UnitizedNumber(g,a);o||(r=r.negate());let u=l.sub(r).abs();if(u.compare(s)>0){let l=[...e.path,"pages",t,"tables",i,"shots",n];e.addIssue({path:[...l,"frontsightInclination"],code:f.ZP.ZodIssueCode.custom,message:`Warning: differs from backsight by ${O(u,2)} (must be within ${s.toString()})`}),e.addIssue({path:[...l,"backsightInclination"],code:f.ZP.ZodIssueCode.custom,message:`Warning: differs from frontsight by ${O(u,2)} (must be within ${s.toString()})`})}}}}}});function O(t,e){return`${t.get(t.unit).toFixed(e)} ${t.unit.toString()}`}let W=f.ZP.tuple([f.ZP.literal("tripHeader"),f.ZP.string()]).transform(t=>{let[,e]=t;return{field:e}}),T=f.ZP.tuple([f.ZP.literal("pages"),f.ZP.number(),f.ZP.literal("tables"),f.ZP.number(),f.ZP.literal("shots"),f.ZP.number(),f.ZP.enum(["distance","frontsightAzimuth","backsightAzimuth","frontsightInclination","backsightInclination"])]).transform(t=>{let[e,n,i,l,o,r,a]=t;return{pageIndex:n,tableIndex:l,shotIndex:r,measurement:a,shotPath:[e,n,i,l,o,r],paths:{fromStationName:[e,n,i,l,o,r,"from","station"],toStationName:[e,n,i,l,o,r+1,"from","station"],isSplit:[e,n,i,l,o,r+1,"isSplit"],splitToStationName:[e,n,i,l,o,r+1,"to","station"]}}}),R=f.ZP.tuple([f.ZP.literal("pages"),f.ZP.number(),f.ZP.literal("tables"),f.ZP.number(),f.ZP.literal("shots"),f.ZP.number(),f.ZP.enum(["from","to"]),f.ZP.enum(["left","right","up","down"])]).transform(t=>{let[e,n,i,l,o,r,a,s]=t;return{pageIndex:n,tableIndex:l,shotIndex:r,station:a,lrud:s,stationNamePath:[e,n,i,l,o,r,a,"station"]}});var H=n(478),N=n(6587);async function X(t){let e=[];for await(let n of t)e.push(n);return e}async function $(t){var e,n,i,l,o,r,a,s,u,d,c,h,f,g,m,v,Z,x,b,I,S,P,k,A,F,L,z,U,C,D,B,O,W,T,R,$,j,E,M,G,_,V;let{tripHeader:Y,pages:q}=t,K="mils"===Y.angleUnit?p.Angle.milsNATO:"gradians"===Y.angleUnit?p.Angle.gradians:p.Angle.degrees,J={name:Y.name,date:Y.date,team:null==(e=(null==(n=Y.team)?void 0:n.includes(";"))?Y.team.split(";"):null==(i=Y.team)?void 0:i.split(","))?void 0:e.map(t=>t.trim()),distanceUnit:"meters"===Y.distanceUnit?p.Length.meters:p.Length.feet,azimuthUnit:K,inclinationUnit:K,hasBacksightAzimuth:!0,hasBacksightInclination:!0,backsightAzimuthCorrected:Y.backsightAzimuthCorrected,backsightInclinationCorrected:Y.backsightInclinationCorrected},Q="feet"===Y.distanceUnit?p.Length.feet:p.Length.meters,tt="gradians"===Y.angleUnit?p.Angle.gradians:"mils"===Y.angleUnit?p.Angle.milsNATO:p.Angle.degrees;function te(t){return null!=t?new p.UnitizedNumber(t,Q):void 0}function tn(t){return null!=t?new p.UnitizedNumber(t,tt):void 0}let ti=[];for(let{tables:t}of q)for(let{shots:e}of t)for(let t=0;t<e.length-1;t++){let n=null==(o=e[t])||null==(l=o.from)?void 0:l.station;if(!n)continue;let i=te(y(null==(r=e[t])?void 0:r.distance));i&&ti.push({from:n,to:(null==(a=e[t+1])?void 0:a.isSplit)?null==(u=e[t+1])||null==(s=u.to)?void 0:s.station:null==(c=e[t+1])||null==(d=c.from)?void 0:d.station,kind:H.FrcsShotKind.Normal,distance:i,excludeDistance:w(null==(h=e[t])?void 0:h.distance),frontsightAzimuth:tn(null==(f=e[t])?void 0:f.frontsightAzimuth),backsightAzimuth:tn(null==(g=e[t])?void 0:g.backsightAzimuth),frontsightInclination:tn(null==(m=e[t])?void 0:m.frontsightInclination),backsightInclination:tn(null==(v=e[t])?void 0:v.backsightInclination),fromLruds:{left:te(null==(x=e[t])||null==(Z=x.from)?void 0:Z.left),right:te(null==(I=e[t])||null==(b=I.from)?void 0:b.right),up:te(null==(P=e[t])||null==(S=P.from)?void 0:S.up),down:te(null==(A=e[t])||null==(k=A.from)?void 0:k.down)},toLruds:(null==(F=e[t+1])?void 0:F.isSplit)?{left:te(null==(z=e[t+1])||null==(L=z.to)?void 0:L.left),right:te(null==(C=e[t+1])||null==(U=C.to)?void 0:U.right),up:te(null==(B=e[t+1])||null==(D=B.to)?void 0:D.up),down:te(null==(W=e[t+1])||null==(O=W.to)?void 0:O.down)}:{left:te(null==(R=e[t+1])||null==(T=R.from)?void 0:T.left),right:te(null==(j=e[t+1])||null==($=j.from)?void 0:$.right),up:te(null==(M=e[t+1])||null==(E=M.from)?void 0:E.up),down:te(null==(_=e[t+1])||null==(G=_.from)?void 0:G.down)},comment:null==(V=e[t+1])?void 0:V.notes})}return(Y.cave?"":` *
`)+(await X((0,N.formatFrcsSurveyFile)({cave:Y.cave,trips:[{header:J,shots:ti}]}))).join("")}let j=(0,n(5104).F)({schema:B});var E=n(6798),M=n(2553),G=n(7889),_=n.n(G),V=n(5439),Y=n.n(V);function q(t){var e,n;let{value:o}=j.useField([]),[r,a]=l.useState(""),[s,u]=l.useState(void 0),d=l.useMemo(()=>(0,h.Z)(async t=>{let e=D.safeParse(t);if(!e.success)return void u(e.error);let n=e.data;try{let t="FRCS"===n.outputFormat?await $(n):"Compass"===n.outputFormat?await function(t){let{tripHeader:e,pages:n}=t,i="meters"===e.distanceUnit?E.DistanceUnit.Meters:E.DistanceUnit.FeetAndInches,l={cave:e.cave||"",name:e.name,team:e.team,date:e.date||new Date,declination:p.Unitize.degrees(0),distanceUnit:i,azimuthUnit:"gradians"===e.angleUnit?E.AzimuthUnit.Gradians:E.AzimuthUnit.Degrees,inclinationUnit:"gradians"===e.angleUnit?E.InclinationUnit.Gradians:E.InclinationUnit.Degrees,hasRedundantBacksights:!0,lrudUnit:i,shotOrder:[E.ShotItem.Distance,E.ShotItem.FrontsightAzimuth,E.ShotItem.BacksightAzimuth,E.ShotItem.FrontsightInclination,E.ShotItem.BacksightInclination],lrudOrder:[E.LrudItem.Left,E.LrudItem.Up,E.LrudItem.Down,E.LrudItem.Right],lrudAssociation:E.LrudAssociation.ToStation},o="feet"===e.distanceUnit?p.Length.feet:p.Length.meters,r="gradians"===e.angleUnit?p.Angle.gradians:"mils"===e.angleUnit?p.Angle.milsNATO:p.Angle.degrees;function a(t){return null!=t?new p.UnitizedNumber(t,o):void 0}function s(t){return null!=t?new p.UnitizedNumber(t,r):void 0}let u=[];for(let{tables:t}of n)for(let{shots:n}of t)for(let t=0;t<n.length-1;t++){var d,c,h,f,g,m,v,Z,x,b,I,S,P,k,A,F,L,z,U,C,D,B,O,W,T,R,H,N,X,$,j;let i=null==(c=n[t])||null==(d=c.from)?void 0:d.station;if(!i)continue;let l=(null==(h=n[t+1])?void 0:h.isSplit)?null==(g=n[t+1])||null==(f=g.to)?void 0:f.station:null==(v=n[t+1])||null==(m=v.from)?void 0:m.station;if(!l)continue;let o=a(y(null==(Z=n[t])?void 0:Z.distance));if(!o)continue;let r=s(null==(x=n[t])?void 0:x.backsightAzimuth);r&&e.backsightAzimuthCorrected&&(r=p.Angle.opposite(r));let E=s(null==(b=n[t])?void 0:b.backsightInclination);E&&e.backsightInclinationCorrected&&(E=E.negate()),u.push({from:i,to:l,distance:o,excludeDistance:w(null==(I=n[t])?void 0:I.distance),frontsightAzimuth:s(null==(S=n[t])?void 0:S.frontsightAzimuth),backsightAzimuth:r,frontsightInclination:s(null==(P=n[t])?void 0:P.frontsightInclination),backsightInclination:E,...(null==(k=n[t+1])?void 0:k.isSplit)?{left:a(null==(F=n[t+1])||null==(A=F.to)?void 0:A.left),right:a(null==(z=n[t+1])||null==(L=z.to)?void 0:L.right),up:a(null==(C=n[t+1])||null==(U=C.to)?void 0:U.up),down:a(null==(B=n[t+1])||null==(D=B.to)?void 0:D.down)}:{left:a(null==(W=n[t+1])||null==(O=W.from)?void 0:O.left),right:a(null==(R=n[t+1])||null==(T=R.from)?void 0:T.right),up:a(null==(N=n[t+1])||null==(H=N.from)?void 0:H.up),down:a(null==($=n[t+1])||null==(X=$.from)?void 0:X.down)},comment:null==(j=n[t+1])?void 0:j.notes})}return(0,E.formatCompassTripHeader)(l)+u.map(t=>(0,E.formatCompassShot)(l)(t)).join("")}(n):"Walls"===n.outputFormat?await function(t){let{tripHeader:{cave:e,name:n,team:i,date:l,distanceUnit:o,angleUnit:r,backsightAzimuthCorrected:a,backsightInclinationCorrected:s,frontsightBacksightTolerance:u},pages:d}=t,c="mils"===r?p.Angle.milsNATO:p.Angle[r],h=null!=u?new p.UnitizedNumber(u,c):p.Unitize.degrees(2),f=[];e&&f.push({type:M.SrvLineType.Comment,comment:`Cave: ${e}`}),n&&f.push({type:M.SrvLineType.Comment,comment:`Trip: ${n}`}),i&&f.push({type:M.SrvLineType.Comment,comment:`Team: ${i}`}),l&&f.push({type:M.SrvLineType.DateDirective,date:l}),f.push({type:M.SrvLineType.UnitsDirective,options:[{type:M.UnitsOptionType.DistanceUnit,unit:"feet"===o?p.Length.feet:p.Length.meters},{type:M.UnitsOptionType.FrontsightAzimuthUnit,unit:"gradians"===r?p.Angle.gradians:"mils"===r?p.Angle.milsNATO:p.Angle.degrees},{type:M.UnitsOptionType.FrontsightInclinationUnit,unit:"gradians"===r?p.Angle.gradians:"mils"===r?p.Angle.milsNATO:p.Angle.degrees},{type:M.UnitsOptionType.Order,order:[M.CompassAndTapeItem.Distance,M.CompassAndTapeItem.Azimuth,M.CompassAndTapeItem.Inclination]},{type:M.UnitsOptionType.LrudStyle,style:M.LrudStyle.ToStationBisector,order:[M.LrudItem.Left,M.LrudItem.Right,M.LrudItem.Up,M.LrudItem.Down]},{type:M.UnitsOptionType.BacksightAzimuthType,isCorrected:a||!1,tolerance:h,doNotAverage:!1},{type:M.UnitsOptionType.BacksightInclinationType,isCorrected:s||!1,tolerance:h,doNotAverage:!1}]});let g="feet"===o?p.Length.feet:p.Length.meters,m="gradians"===r?p.Angle.gradians:"mils"===r?p.Angle.milsNATO:p.Angle.degrees;function v(t){return null!=t?new p.UnitizedNumber(t,g):void 0}function Z(t){return null!=t?new p.UnitizedNumber(t,m):void 0}for(let{tables:t}of d)for(let{shots:e}of t)for(let t=0;t<e.length-1;t++){var x,b,w,I,S,P,k,A,F,L,z,U,C,D,B,O,W,T,R,H,N,X,$,j,E,G,_,V,Y,q;let n=null==(b=e[t])||null==(x=b.from)?void 0:x.station;if(!n)continue;let i=(null==(w=e[t+1])?void 0:w.isSplit)?null==(S=e[t+1])||null==(I=S.to)?void 0:I.station:null==(k=e[t+1])||null==(P=k.from)?void 0:P.station;if(!i)continue;let l=v(y(null==(A=e[t])?void 0:A.distance));l&&f.push({type:M.SrvLineType.Shot,from:n,to:i,measurements:{type:M.ShotType.CompassAndTape,distance:l,frontsightAzimuth:Z(null==(F=e[t])?void 0:F.frontsightAzimuth),backsightAzimuth:Z(null==(L=e[t])?void 0:L.backsightAzimuth),frontsightInclination:Z(null==(z=e[t])?void 0:z.frontsightInclination),backsightInclination:Z(null==(U=e[t])?void 0:U.backsightInclination)},...(null==(C=e[t+1])?void 0:C.isSplit)?{left:v(null==(B=e[t+1])||null==(D=B.to)?void 0:D.left),right:v(null==(W=e[t+1])||null==(O=W.to)?void 0:O.right),up:v(null==(R=e[t+1])||null==(T=R.to)?void 0:T.up),down:v(null==(N=e[t+1])||null==(H=N.to)?void 0:H.down)}:{left:v(null==($=e[t+1])||null==(X=$.from)?void 0:X.left),right:v(null==(E=e[t+1])||null==(j=E.from)?void 0:j.right),up:v(null==(_=e[t+1])||null==(G=_.from)?void 0:G.up),down:v(null==(Y=e[t+1])||null==(V=Y.from)?void 0:V.down)},comment:null==(q=e[t+1])?void 0:q.notes})}return(0,M.formatWallsSrvFile)({lines:f})}(n):"";setTimeout(()=>{a(t),u(void 0)},0)}catch(t){u(t)}},500),[]);return l.useEffect(()=>{d(o)},[o]),(0,i.tZ)(i.HY,{children:(0,i.tZ)(c.Z,{multiline:!0,value:null!=s?(e=s,n=o,e instanceof f.z.ZodError?"The following fields are invalid:\n"+e.issues.map(t=>{{let e=W.safeParse(t.path);if(e.success){let{field:t}=e.data;return`Invalid ${_()(t)}`}}{let e=R.safeParse(t.path);if(e.success){let{pageIndex:t,shotIndex:i,lrud:l,stationNamePath:o}=e.data,r=Y()(n,o);return`Invalid ${_()(l)}${"string"==typeof r?` at station ${r}`:` at station ${i+1}`} (Page ${t+1})`}}{let e=T.safeParse(t.path);if(e.success){let{pageIndex:t,shotIndex:i,measurement:l,paths:o}=e.data,r=Y()(n,o.fromStationName),a=!0===Y()(n,o.isSplit)?Y()(n,o.splitToStationName):Y()(n,o.toStationName);return`Invalid ${_()(l)}${"string"==typeof r||"string"==typeof a?` from station ${r||"<blank>"} to ${a||"<blank>"}`:` in shot ${i+1}`} (Page ${t+1})`}}return`${t.message} (at ${t.path.join(", ")})`}).map(t=>`- ${t}`).join("\n"):e instanceof Error?e.message:String(e)):r,InputProps:{readOnly:!0,sx:{fontFamily:"monospace"}},error:null!=s,...t})})}var K=n(8209),J=n.n(K),Q=n(9939),tt=n(7167),te=n(9324),tn=n(1359),ti=n(6261),tl=n(1656);function to(t,e){return(0,l.useCallback)(n=>{let{clientX:i,clientY:l}=n;if("object"!=typeof document)return;let{body:o}=document;function r(n){t(n,{dx:n.clientX-i,dy:n.clientY-l,dragStartProps:e})}o&&(o.addEventListener("mousemove",r,!0),o.addEventListener("mouseup",function n(a){o.removeEventListener("mousemove",r,!0),o.removeEventListener("mouseup",n),t(a,{dx:a.clientX-i,dy:a.clientY-l,dragStartProps:e})}),t(n,{dx:0,dy:0,dragStartProps:e}))},[t])}function tr(t){var e,n,o;let{sx:r,slotProps:a,children:s,...u}=t,c=l.Children.toArray(s);if(2!==c.length)throw Error("must have two children");let[h,f]=c,[g,m]=l.useState(.5),p=l.useRef(null),v=to((t,e)=>{let{dx:n,dragStartProps:{splitPosition:i}}=e,l=p.current;l&&(t.preventDefault(),t.stopPropagation(),m(i+n/l.offsetWidth))},{splitPosition:g});return(0,i.BX)(d.Z,{...u,ref:p,sx:{display:"flex",flexDirection:"row",flexWrap:"nowrap",overflow:"hidden",alignItems:"stretch",...r},children:[(0,i.tZ)(d.Z,{...null==a?void 0:a.left,sx:{flexGrow:0,flexShrink:0,minWidth:0,display:"flex",flexDirection:"column",overflow:"auto",...null==a||null==(e=a.left)?void 0:e.sx},style:{flexBasis:`${100*g}%`,...null==a||null==(n=a.left)?void 0:n.style},children:h}),(0,i.tZ)(d.Z,{sx:{width:0,position:"relative"},children:(0,i.tZ)(d.Z,{onMouseDown:v,sx:{position:"absolute",top:0,bottom:0,left:-4,width:8,cursor:"col-resize"}})}),(0,i.tZ)(d.Z,{...null==a?void 0:a.right,sx:{minWidth:0,flexGrow:1,flexShrink:1,flexBasis:0,display:"flex",flexDirection:"column",overflow:"auto",...null==a||null==(o=a.right)?void 0:o.sx},children:f})]})}var ta=n(6336),ts=n(4549),tu=n(7958),td=n(9002),tc=n.n(td);let th=[t=>{t.createObjectStore("pageImages")}],tf=tc()(async function(){return await (0,tu.X3)("my-db",th.length+1,{upgrade(t,e){for(let n of th.slice(e-1))n(t)}})}),tg=l.createContext(void 0);function tm(t){let{idb:e,children:n}=t;return(0,i.tZ)(tg.Provider,{value:e,children:n})}var tp=n(191),tv=n(1479),tZ=n(8057);function tx(t){let{label:e,...n}=t;return(0,i.BX)(tv.Z,{children:[(0,i.tZ)(tZ.Z,{...n}),e]})}function tb(t){let{field:e,...n}=t,{input:l}=(0,tp.useHtmlField)({field:e,type:"checkbox"});return(0,i.tZ)(tx,{...l,...n})}var ty=n(1529),tw=n(8028),tI=n(1200),tS=n(1930),tP=n(3493);let tk=t=>{let{index:e,x:n,y:o,h:r=1,useFieldProps:a,sx:s,inputProps:u,InputProps:d,...h}=t,{validationError:f,...g}=(null==a?void 0:a(e))||{},m=l.useCallback(t=>{let e,i,l=t.target instanceof HTMLInputElement?t.target:void 0;switch(t.key){case"ArrowUp":t.preventDefault(),e=[[n,o-1,1],[n,o-2,2]];break;case"ArrowDown":t.preventDefault(),e=[[n,o+r]];break;case"ArrowLeft":e=2===r?[[n-1,o+1,1],[n-1,o-1,2],[n-1,o],[n-1,o-1]]:[[n-1,o],[n-1,o-1,2],[n-1,o-1]];break;case"ArrowRight":var a;l&&l.selectionEnd===(null==(a=l.value)?void 0:a.length)&&(e=2===r?[[n+1,o],[n+1,o+1],[n+1,o-1,2]]:[[n+1,o],[n+1,o-1,2]])}let s=null==l?void 0:l.closest('[data-component="SurveyPageFields"]');for(let[t,n,l]of e||[]){let e=null==s?void 0:s.querySelector(`[data-x="${t}"][data-y="${n}"]${null!=l?`[data-h="${l}"]`:""}`);if(e instanceof HTMLInputElement){i=e;break}}i&&(t.preventDefault(),i.focus(),i.select())},[n,o,r]),p=l.useRef(null),v=(0,tP.Z)(p,null==d?void 0:d.inputRef),Z=l.useCallback(()=>{let t=p.current;null!=t&&document.activeElement!==t&&t.focus()},[]),x=l.useCallback(()=>{var t;null==(t=p.current)||t.select()},[]);return(0,i.tZ)(c.Z,{...g,...h,error:null!=f,onKeyDown:m,onFocus:x,sx:{flexGrow:1,flexShrink:1,flexBasis:0,backgroundColor:(null==g?void 0:g.value)?"rgba(255, 255, 255, 0.8)":"none","& input":{padding:"2px",textAlign:"center"},...s},inputProps:{"data-x":n,"data-y":o,"data-h":r,...u},InputProps:{...d,inputRef:v,sx:{borderRadius:0,height:"100%",fontSize:"0.8rem",...null==d?void 0:d.sx},endAdornment:f?(0,i.tZ)(ti.Z,{position:"end",sx:{ml:0,mr:-1.5},onClick:Z,children:(0,i.tZ)(Q.Z,{disableInteractive:!0,title:"string"==typeof f?f.replace(/Warning:\s+/,""):f,children:"string"==typeof f&&f.startsWith("Warning")?(0,i.tZ)(tI.Z,{sx:{color:"orange",height:16,width:16}}):(0,i.tZ)(tS.Z,{sx:{color:"red",height:16,width:16}})})}):void 0}})},tA={Lech:{staggered:!0,numRows:11,stationWidth:"19%",shotWidth:"37.5%",notes:"afterLrud",notesWidth:"43%"},IMO:{staggered:!0,numRows:11,stationWidth:"16%",shotWidth:"40%",notes:"afterLrud",notesWidth:"30%"},"X-38":{staggered:!0,numRows:10,stationWidth:"18%",shotWidth:"38%",distanceWidth:"38%",azimuthWidth:"30%",inclinationWidth:"30%",notes:"afterInclination",notesWidth:"12%"},"X-39":{staggered:!0,numRows:10,stationWidth:"18%",shotWidth:"38.5%",distanceWidth:"38%",azimuthWidth:"30%",inclinationWidth:"30%",lrudWidths:{left:"23%",right:"23%",up:"25%",down:"28%"},notes:"afterInclination",notesWidth:"12%"},FromStaDisAzIncLrUd:{staggered:!1,numRows:26,station:"from",stationWidth:"16%",shotWidth:"50%"},ToStaDisAzIncLrUd:{staggered:!1,numRows:26,station:"to",stationWidth:"16%",shotWidth:"50%"}},tF=l.memo(function(t){let{useFieldProps:e,layoutVariant:n="IMO"}=t,l=tA[n].numRows;return(0,i.tZ)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch",width:"100%",height:"100%"},"data-component":"SurveyPageFields",children:[...Array(l).keys()].map(t=>(0,i.tZ)(tz,{sx:{flexBasis:`${100/l}%`},index:t,layoutVariant:n,useFieldProps:e,includeShotFields:t<l-1},t))})}),tL=["left","right","up","down"],tz=t=>{var e,n,l,o;let{sx:r,index:a,useFieldProps:s,includeShotFields:u=!0,layoutVariant:c}=t,h=null==s||null==(e=s.isSplit)?void 0:e.call(s,a),f=tA[c],{staggered:g}=f,m=!!g&&(null==h?void 0:h.value)===!0,p=f.staggered||"to"!==f.station?a:a+1,v=0,Z=g?2*a:a,x=g?Z+1:Z,b=g?Z+2:Z,y={fromStation:0,toStation:0,distance:++v,frontsightAzimuth:++v,backsightAzimuth:g?v:++v,frontsightInclination:++v,backsightInclination:g?v:++v,left:++v,right:++v,up:++v,down:++v,notes:++v},w={position:"relative",flexGrow:0,flexShrink:0,flexBasis:f.stationWidth,"&:not(:hover) > :nth-child(1)":{visibility:"hidden"}};return(0,i.BX)(d.Z,{sx:{...r,flexGrow:1,flexShrink:1,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch"},children:[m?(0,i.BX)(tU,{sx:w,children:[(0,i.tZ)(Q.Z,{title:"Unsplit row",placement:"right",disableInteractive:!0,children:(0,i.tZ)(ty.Z,{size:"small",tabIndex:-1,sx:{position:"absolute",top:"50%",left:0,mt:-2,ml:-2,height:32,width:32,minHeight:32},onClick:()=>null==h?void 0:h.setValue(!1),children:(0,i.tZ)(tw.Z,{})})}),(0,i.tZ)(tk,{x:y.toStation,y:Z,index:a,useFieldProps:null==s||null==(n=s.to)?void 0:n.station}),(0,i.tZ)(tk,{x:y.fromStation,y:Z+1,index:a,useFieldProps:null==s||null==(l=s.from)?void 0:l.station})]}):(0,i.BX)(d.Z,{sx:{...w,display:"flex"},children:[g?(0,i.tZ)(Q.Z,{title:"Split row",placement:"right",disableInteractive:!0,children:(0,i.tZ)(ty.Z,{size:"small",tabIndex:-1,sx:{position:"absolute",top:"50%",left:0,mt:-2,ml:-2,height:32,width:32,minHeight:32},onClick:()=>null==h?void 0:h.setValue(!0),children:(0,i.tZ)(tw.Z,{})})}):(0,i.tZ)("span",{}),(0,i.tZ)(tk,{x:y.fromStation,y:Z,h:g?2:1,index:p,useFieldProps:null==s||null==(o=s.from)?void 0:o.station})]}),(0,i.tZ)(d.Z,{sx:{position:"relative",flexGrow:0,flexShrink:0,flexBasis:f.shotWidth,pointerEvents:"none"},children:u&&(0,i.BX)(d.Z,{sx:{position:"absolute",top:g?"50%":"0%",width:"100%",height:"100%",display:"flex",alignItems:"stretch",pointerEvents:"all"},children:[(0,i.tZ)(tk,{x:y.distance,y:x,h:g?2:1,index:a,useFieldProps:null==s?void 0:s.distance,sx:{flexBasis:f.distanceWidth??0,flexGrow:1,flexShrink:1}}),(0,i.BX)(tU,{sx:{flexBasis:f.azimuthWidth??0,flexGrow:1,flexShrink:1,flexDirection:g?"column":"row"},children:[(0,i.tZ)(tk,{x:y.frontsightAzimuth,y:x,index:a,useFieldProps:null==s?void 0:s.frontsightAzimuth}),(0,i.tZ)(tk,{x:y.backsightAzimuth,y:b,index:a,useFieldProps:null==s?void 0:s.backsightAzimuth})]}),(0,i.BX)(tU,{sx:{flexBasis:f.inclinationWidth??0,flexGrow:1,flexShrink:1,flexDirection:g?"column":"row"},children:[(0,i.tZ)(tk,{x:y.frontsightInclination,y:x,index:a,useFieldProps:null==s?void 0:s.frontsightInclination}),(0,i.tZ)(tk,{x:y.backsightInclination,y:b,index:a,useFieldProps:null==s?void 0:s.backsightInclination})]})]})}),"afterInclination"===f.notes?(0,i.tZ)(tk,{x:y.notes,y:Z,h:g?2:1,index:a,useFieldProps:null==s?void 0:s.notes,sx:{flexGrow:0,flexShrink:0,flexBasis:"12%"}}):void 0,(0,i.BX)(d.Z,{sx:{flexBasis:f.lrudWidth??0,flexGrow:1,flexShrink:1,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch"},children:[tL.map((t,e)=>{var n,l,o,r,u,d;return m?(0,i.BX)(tU,{children:[(0,i.tZ)(tk,{x:y[tL[e]],y:Z,index:a,useFieldProps:null==s||null==(n=s.to)?void 0:n[t],sx:{flexBasis:(null==(l=f.lrudWidths)?void 0:l[t])??0}}),(0,i.tZ)(tk,{x:y[tL[e]],y:Z+1,index:a,useFieldProps:null==s||null==(o=s.from)?void 0:o[t],sx:{flexBasis:(null==(r=f.lrudWidths)?void 0:r[t])??0}})]},t):(0,i.tZ)(tk,{x:y[tL[e]],y:Z,h:g?2:1,index:p,useFieldProps:null==s||null==(u=s.from)?void 0:u[t],sx:{flexBasis:(null==(d=f.lrudWidths)?void 0:d[t])??0}},t)}),"afterLrud"===f.notes?(0,i.tZ)(tk,{x:y.notes,y:Z,h:g?2:1,index:a,useFieldProps:null==s?void 0:s.notes,sx:{flexGrow:0,flexShrink:0,flexBasis:f.notesWidth}}):void 0]})]})};function tU(t){let{sx:e,children:n}=t;return(0,i.tZ)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch",...e},children:n})}var tC=n(3671),tD=n(6888);function tB(t){let{sx:e,children:n,width:o,height:r,bounds:a,...s}=t,u=l.useMemo(()=>{let t=(0,tD.calculateHomography)([0,0],[a.topLeft.x,a.topLeft.y],[o,0],[a.topRight.x,a.topRight.y],[o,r],[a.bottomRight.x,a.bottomRight.y],[0,r],[a.bottomLeft.x,a.bottomLeft.y]);return`matrix3d(${[t.get([0,0]),t.get([1,0]),0,t.get([2,0]),t.get([0,1]),t.get([1,1]),0,t.get([2,1]),0,0,1,0,t.get([0,2]),t.get([1,2]),0,t.get([2,2])].join(",")})`},[a,o,r]);return(0,i.tZ)(d.Z,{...s,sx:{...e,position:"absolute",top:0,left:0,width:o,height:r,transform:u,transformOrigin:"top left"},children:n})}function tO(t){let{handleSize:e=9,bounds:n,sx:l,onResize:o}=t,r=t=>to((e,n)=>{let{dx:i,dy:l,dragStartProps:{bounds:r}}=n;e.preventDefault(),e.stopPropagation(),o({...r,[t]:{x:r[t].x+i,y:r[t].y+l}})},{bounds:n}),a=t=>{let{x:i,y:l}=t;return{position:"absolute",top:l-n.topLeft.y-Math.ceil(e/2),left:i-n.topLeft.x-Math.ceil(e/2),width:e,height:e,cursor:"grab",backgroundColor:"currentColor",pointerEvents:"all"}};return(0,i.tZ)(i.HY,{children:(0,i.BX)(d.Z,{sx:{top:n.topLeft.y,left:n.topLeft.x,width:n.bottomRight.x-n.topLeft.x,height:n.bottomRight.y-n.topLeft.y,boxSizing:"border-box",position:"absolute",color:"red",pointerEvents:"none",...l},children:[(0,i.tZ)(d.Z,{sx:a(n.topLeft),onMouseDown:r("topLeft")}),(0,i.tZ)(d.Z,{sx:a(n.topRight),onMouseDown:r("topRight")}),(0,i.tZ)(d.Z,{sx:a(n.bottomRight),onMouseDown:r("bottomRight")}),(0,i.tZ)(d.Z,{sx:a(n.bottomLeft),onMouseDown:r("bottomLeft")})]})})}var tW=n(9828),tT=n(8865);function tR(t){let{field:e,type:n,...l}=t,{input:o,meta:r}=(0,tp.useHtmlField)({field:e,type:n}),a=r.touched&&null!=r.error;return(0,i.tZ)(c.Z,{...o,error:a,...l,helperText:r.error})}function tH(t){let{field:e}=t;return(0,i.BX)(tR,{variant:"filled",type:"text",field:e,select:!0,label:"Layout",sx:{backgroundColor:"rgba(255, 255, 255, 0.8)"},children:[(0,i.tZ)(tn.Z,{value:"IMO",children:"Inner Mountain Outfitters"}),(0,i.tZ)(tn.Z,{value:"Lech",children:"Lechuguilla"}),(0,i.tZ)(tn.Z,{value:"X-38",children:"Cave Research Foundation X-38"}),(0,i.tZ)(tn.Z,{value:"X-39",children:"Cave Research Foundation X-39"}),(0,i.tZ)(tn.Z,{value:"FromStaDisAzIncLrUd",children:"From Sta | Dist | Az F/B | Inc F/B | L R | U D"}),(0,i.tZ)(tn.Z,{value:"ToStaDisAzIncLrUd",children:"To Sta | Dist | Az F/B | Inc F/B | L R | U D"})]})}function tN(t){let{field:e,onDelete:n}=t,o=e.get("tables[0]"),{value:r}=(0,tW.useField)(e.get("imageId")),a=(0,tT.a)({queryKey:["pageImages",r],queryFn:async()=>{if(!r)return null;let t=await (await tf()).get("pageImages",r);return t?await new Promise((e,n)=>{let i=new FileReader;i.readAsDataURL(t),i.onload=()=>{"string"==typeof i.result&&e(i.result)},i.onerror=n}):null}}),{parsedValue:s,setValue:u}=(0,tW.useField)(o.get("bounds")),{value:c="IMO"}=(0,tW.useField)(o.get("layoutVariant")),h=l.useMemo(()=>{let t,e=t=>e=>{let{input:n,meta:{error:i}}=(0,tp.useHtmlField)({field:t(o.get(["shots",e])),type:"text"});return{...n,...i?{validationError:i}:{}}};return{from:{station:e(t=>t.get("from.station")),left:e(t=>t.get("from.left")),right:e(t=>t.get("from.right")),up:e(t=>t.get("from.up")),down:e(t=>t.get("from.down"))},to:{station:e(t=>t.get("to.station")),left:e(t=>t.get("to.left")),right:e(t=>t.get("to.right")),up:e(t=>t.get("to.up")),down:e(t=>t.get("to.down"))},isSplit:(t=t=>t.get("isSplit"),e=>(0,tW.useField)(t(o.get(["shots",e])))),distance:e(t=>t.get("distance")),frontsightAzimuth:e(t=>t.get("frontsightAzimuth")),backsightAzimuth:e(t=>t.get("backsightAzimuth")),frontsightInclination:e(t=>t.get("frontsightInclination")),backsightInclination:e(t=>t.get("backsightInclination")),notes:e(t=>t.get("notes"))}},[o]);return s?(0,i.BX)(d.Z,{sx:{position:"relative"},children:[(0,i.tZ)(d.Z,{sx:{userSelect:"none"},children:(0,i.tZ)("img",{src:a.data??void 0,alt:"survey sheet",height:800})}),(0,i.BX)(tX,{children:[(0,i.BX)(tB,{width:420,height:600,bounds:s,sx:{border:"1px solid red"},children:[(0,i.BX)(d.Z,{sx:{position:"absolute",top:-64,left:0,display:"flex",gap:2},children:[(0,i.tZ)(tH,{field:o.get("layoutVariant")}),(0,i.tZ)(ty.Z,{onClick:n,children:(0,i.tZ)(tC.Z,{})})]}),(0,i.tZ)(tF,{layoutVariant:c,useFieldProps:h})]}),(0,i.tZ)(tO,{bounds:s,onResize:u})]})]}):null}function tX(t){let{children:e}=t,{value:n}=j.useField("hideOverlay");return(0,i.tZ)("div",{style:{opacity:+!n},children:e})}var t$=n(4933);function tj(){let{elements:t,push:e,remove:n}=j.useArrayField("pages"),o=function(){let t=l.useContext(tg);if(!t)throw Error("must be used inside an IdbProvider");return t}(),r=l.useCallback(t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy"},[]),a=l.useCallback(async t=>{t.preventDefault();let{files:n}=t.dataTransfer;for(let t of n){let n=t$.Z();await o.add("pageImages",t,n),e({imageId:n,tables:[{layoutVariant:"IMO",bounds:function(t){let{top:e,left:n,width:i,height:l}=t;return{topLeft:{x:n,y:e},topRight:{x:n+i,y:e},bottomLeft:{x:n,y:e+l},bottomRight:{x:n+i,y:e+l}}}({top:113,left:15,width:520,height:632})}]})}},[e]);return(0,i.BX)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",overflow:"scroll",flexGrow:1,flexShrink:1,alignSelf:"stretch",minHeight:0},onDragOver:r,onDrop:a,children:[t.map((t,e)=>(0,i.tZ)(tN,{field:t,onDelete:()=>n(e)},e)),t.length?void 0:(0,i.tZ)(d.Z,{sx:{height:200,textAlign:"center",my:10,alignSelf:"stretch",color:"gray"},children:"Drop images here"})]})}var tE=n(3740);function tM(t){let{field:e,children:n}=t;return n((0,tW.useField)(e))??null}let tG=new ta.S,{FormProvider:t_,useInitialize:tV}=j;function tY(){let[t,e]=l.useState();return(tf().then(e),t)?(0,i.tZ)(tm,{idb:t,children:(0,i.tZ)(ts.aH,{client:tG,children:(0,i.tZ)(t_,{children:(0,i.tZ)(tK,{})})})}):"Loading..."}let tq={outputFormat:"FRCS",tripHeader:{name:"",team:"",angleUnit:"degrees",distanceUnit:"feet",backsightAzimuthCorrected:!0,backsightInclinationCorrected:!0,frontsightBacksightTolerance:2},pages:[]};function tK(){tV({values:l.useMemo(()=>{try{let t=JSON.parse(localStorage.getItem("caveSurveyDataValues")||"");if("object"!=typeof t||null==t)throw Error();if(!t.tripHeader)for(let e of(t.tripHeader={},Object.keys(tq.tripHeader)))null==t.tripHeader[e]&&(t.tripHeader[e]=tq.tripHeader[e]);return t.outputFormat||(t.outputFormat=tq.outputFormat),t}catch(t){return tq}},[])},[]);let{value:t,setValue:e}=j.useField("hideHeader"),n=l.useCallback(()=>e(!t),[t,e]);return(0,i.BX)(i.HY,{children:[(0,i.tZ)(t0,{}),(0,i.tZ)(t1,{}),(0,i.BX)(tr,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0},slotProps:{right:{sx:{pt:2}}},children:[(0,i.BX)(d.Z,{sx:{flexGrow:1,flexShrink:1,gap:1,display:"flex",flexDirection:"column",alignItems:"stretch",overflow:"hidden"},children:[(0,i.BX)(d.Z,{sx:{display:"flex",flexDirection:"row",gap:1},children:[(0,i.tZ)(tJ,{}),(0,i.tZ)(tQ,{}),(0,i.tZ)(tb,{field:j.get("hideOverlay"),label:"Hide Overlay (Alt/⌥)"}),(0,i.tZ)(d.Z,{sx:{flex:1}}),(0,i.tZ)(Q.Z,{disableInteractive:!0,title:t?"Show Trip Header":"Hide Trip Header",children:(0,i.tZ)(tt.Z,{onClick:n,children:(0,i.tZ)(tE.Z,{sx:{transition:"transform",transform:t?"scaleY(1)":"scaleY(-1)"}})})})]}),(0,i.tZ)(te.Z,{in:!t,sx:{flexShrink:0},children:(0,i.BX)(d.Z,{sx:{p:1,flexGrow:1,flexShrink:1,gap:1,display:"flex",flexDirection:"column",alignItems:"stretch",overflow:"hidden"},children:[(0,i.tZ)(tR,{type:"text",label:"Cave Name",field:j.get("tripHeader.cave"),fullWidth:!0}),(0,i.BX)(d.Z,{sx:{display:"flex",flexDirection:"row",gap:1},children:[(0,i.tZ)(tR,{type:"text",label:"Trip Name",field:j.get("tripHeader.name"),sx:{flex:"1 1 auto"},fullWidth:!0}),(0,i.tZ)(tR,{type:"text",label:"Trip Date",field:j.get("tripHeader.date"),sx:{flex:"1 1 auto"},fullWidth:!0})]}),(0,i.tZ)(tR,{type:"text",label:"Survey Team",field:j.get("tripHeader.team"),fullWidth:!0}),(0,i.BX)(d.Z,{sx:{display:"flex",flexDirection:"row",gap:1,mb:2,alignSelf:"stretch"},children:[(0,i.BX)(tR,{type:"text",field:j.get("tripHeader.distanceUnit"),label:"Distance Unit",select:!0,fullWidth:!0,children:[(0,i.tZ)(tn.Z,{value:"meters",children:"Meters"}),(0,i.tZ)(tn.Z,{value:"feet",children:"Feet"})]}),(0,i.BX)(tR,{type:"text",field:j.get("tripHeader.angleUnit"),label:"Angle Unit",select:!0,fullWidth:!0,children:[(0,i.tZ)(tn.Z,{value:"degrees",children:"Degrees"}),(0,i.tZ)(tn.Z,{value:"gradians",children:"Gradians"}),(0,i.tZ)(tn.Z,{value:"mils",children:"Mils"})]}),(0,i.tZ)(tR,{type:"text",field:j.get("tripHeader.frontsightBacksightTolerance"),label:"Backsight Tolerance",fullWidth:!0,inputProps:{sx:{textAlign:"right"}},InputProps:{endAdornment:(0,i.tZ)(ti.Z,{position:"end",children:(0,i.tZ)(tM,{field:j.get("tripHeader.angleUnit"),children:t=>{let{value:e}=t;return e??null}})})}})]}),(0,i.BX)(d.Z,{sx:{display:"flex",flexDirection:"row",gap:4,mb:2},children:[(0,i.tZ)(tb,{field:j.get("tripHeader.backsightAzimuthCorrected"),label:"Corrected Backsight Azimuths"}),(0,i.tZ)(tb,{field:j.get("tripHeader.backsightInclinationCorrected"),label:"Corrected Backsight Inclinations"})]})]})}),(0,i.tZ)(tj,{})]}),(0,i.BX)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,i.BX)(tR,{field:j.get("outputFormat"),type:"text",label:"Output Format",select:!0,fullWidth:!0,children:[(0,i.tZ)(tn.Z,{value:"FRCS",children:"FRCS"}),(0,i.tZ)(tn.Z,{value:"Compass",children:"Compass"}),(0,i.tZ)(tn.Z,{value:"Walls",children:"Walls"})]}),(0,i.tZ)(q,{fullWidth:!0,sx:{flexGrow:1,flexShrink:1,minHeight:0,mt:2}})]})]})]})}function tJ(){let t=j.useField("tripHeader"),e=j.useField("pages");return(0,i.tZ)(tl.Z,{onClick:()=>{t.setValue({...t.value,cave:"",name:"",team:"",date:""}),e.setValue((e.value||[]).map(t=>{var e;return{...t,tables:null==t||null==(e=t.tables)?void 0:e.map(t=>({...t,shots:[]}))}}))},children:"Clear Data"})}function tQ(){let t=j.useField("tripHeader"),e=j.useField("pages");return(0,i.tZ)(tl.Z,{onClick:()=>{t.setValue({...t.value,cave:"",name:"",team:"",date:""}),e.setValue([])},children:"Clear All"})}function t0(){let{value:t}=j.useField([]),e=l.useMemo(()=>J()(t=>{localStorage.setItem("caveSurveyDataValues",JSON.stringify(t))},500),[]);return l.useEffect(()=>{t&&e(t)},[t]),null}function t1(){let{setValue:t}=j.useField("hideOverlay");return l.useEffect(()=>{function e(e){"Alt"===e.key&&t(!0)}function n(e){"Alt"===e.key&&t(!1)}return document.addEventListener("keydown",e),document.addEventListener("keyup",n),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",n)}},[]),null}let t2=document.getElementById("root");t2&&(0,o.createRoot)(t2).render((0,i.tZ)(function(){return(0,i.BX)(a.Z,{theme:r,children:[(0,i.tZ)(s.ZP,{}),(0,i.tZ)(u.Z,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),(0,i.tZ)(tY,{})]})},{}))}},e={};function n(i){var l=e[i];if(void 0!==l)return l.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;n.t=function(i,l){if(1&l&&(i=this(i)),8&l||"object"==typeof i&&i&&(4&l&&i.__esModule||16&l&&"function"==typeof i.then))return i;var o=Object.create(null);n.r(o);var r={};t=t||[null,e({}),e([]),e(e)];for(var a=2&l&&i;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach(t=>{r[t]=()=>i[t]});return r.default=()=>i,n.d(o,r),o}})(),n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(t){if("object"==typeof window)return window}})(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t=[];n.O=(e,i,l,o)=>{if(i){o=o||0;for(var r=t.length;r>0&&t[r-1][2]>o;r--)t[r]=t[r-1];t[r]=[i,l,o];return}for(var a=1/0,r=0;r<t.length;r++){for(var[i,l,o]=t[r],s=!0,u=0;u<i.length;u++)(!1&o||a>=o)&&Object.keys(n.O).every(t=>n.O[t](i[u]))?i.splice(u--,1):(s=!1,o<a&&(a=o));if(s){t.splice(r--,1);var d=l();void 0!==d&&(e=d)}}return e}})(),n.rv=()=>"1.3.11",(()=>{var t={980:0};n.O.j=e=>0===t[e];var e=(e,i)=>{var l,o,[r,a,s]=i,u=0;if(r.some(e=>0!==t[e])){for(l in a)n.o(a,l)&&(n.m[l]=a[l]);if(s)var d=s(n)}for(e&&e(i);u<r.length;u++)o=r[u],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(d)},i=self.webpackChunk_speleotica_cave_survey_data_entry=self.webpackChunk_speleotica_cave_survey_data_entry||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),n.ruid="bundler=rspack@1.3.11";var i=n.O(void 0,["361","3"],function(){return n(3738)});i=n.O(i)})();